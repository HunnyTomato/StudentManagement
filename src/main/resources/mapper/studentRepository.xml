<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="raisetech.student.management.repository.StudentRepository">

<!-- 受講生の全件検索 -->
<select id="search" resultType="raisetech.student.management.data.Student">
  SELECT * FROM students
</select>

  <!-- 受講生の検索 -->
<select id="searchStudent" resultType="raisetech.student.management.data.Student">
  SELECT * FROM students WHERE id = #{id}
</select>

<insert id="registerStudent" parameterType="raisetech.student.management.data.Student" useGeneratedKeys = "true" keyProperty = "id">
  insert into students_courses(studentId, course, coursesStartDate, coursesExpectedCompletionDate)"
  + values(#{studentId}, #{course}, #{coursesStartDate}, #{coursesExpectedCompletionDate})
</insert>

<insert id="registerStudentCourse" parameterType="raisetech.student.management.data.StudentCourse" useGeneratedKeys="true" keyProperty="id">
  insert into students_courses(studentId, course, coursesStartDate, coursesExpectedCompletionDate)"
  + "values(#{studentId}, #{course}, #{coursesStartDate}, #{coursesExpectedCompletionDate}
</insert>

<update id="updateStudent" parameterType="raisetech.student.management.data.Student">
  update students set name = #{name}, hurigana = #{hurigana}, nickname = #{nickname},"
  + " mailAddress = #{mailAddress}, area = #{area}, age = #{age}, gender = #{gender},"
  + " remark = #{remark}, isDeleted = #{isDeleted} where id = #{id}
</update>

<update id="updateStudentCourse" parameterType="raisetech.student.management.data.StudentCourse">
  update students_courses set course = #{course} where studentId = #{studentId}
</update>
</mapper>